name: ğŸ” RSA å®‰å…¨è¯»å–å¯†é’¥
on: 
  workflow_dispatch:

jobs:
  secure-reveal:
    runs-on: ubuntu-latest
    steps:
      - name: ä½¿ç”¨ RSA å…¬é’¥åŠ å¯† Secret
        env:
          # ä½ çš„ RSA å…¬é’¥ï¼Œå»ºè®®ä¹Ÿå­˜åœ¨ GitHub Secret é‡Œï¼Œæˆ–è€…ç›´æ¥å†™æ­»åœ¨ä¸‹é¢
          PUBLIC_KEY: ${{ secrets.RSA }} 
          TARGET_DATA: ${{ secrets.SKLAND_TOKENS }}
        run: |
          if [ -z "$TARGET_DATA" ]; then
            echo "é”™è¯¯: SKLAND_TOKENS ä¸ºç©º"
            exit 1
          fi
          
          # 1. å°†å…¬é’¥å­—ç¬¦ä¸²ä¿å­˜ä¸ºä¸´æ—¶æ–‡ä»¶
          echo "$PUBLIC_KEY" > public_key.pub
          
          # 2. ä½¿ç”¨ openssl è¿›è¡ŒåŠ å¯†
          # -pubin è¡¨ç¤ºè¾“å…¥çš„æ˜¯å…¬é’¥
          # -rsautl åœ¨è¾ƒæ–°ç‰ˆæœ¬ openssl ä¸­å¯èƒ½éœ€è¦ä½¿ç”¨ pkeyutl
          echo -n "$TARGET_DATA" | openssl pkeyutl -encrypt -pubin -inkey public_key.pub > encrypted.bin
          
          # 3. è¾“å‡º Base64 ç¼–ç åçš„ç»“æœ
          echo "è¯·å¤åˆ¶ä¸‹æ–¹çš„åŠ å¯†å­—ç¬¦ä¸²åˆ° Termux è§£å¯†ï¼š"
          echo "------------------------------------------------"
          base64 -w 0 encrypted.bin
          echo -e "\n------------------------------------------------"
